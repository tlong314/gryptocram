var Gryptocram=function(){var e={},t={},n="",o=[],r=0,l="",d=document.body,a=!1,s=window.location.pathname.substr(window.location.pathname.lastIndexOf("/")+1,window.location.pathname.lastIndexOf(".html")-1-window.location.pathname.lastIndexOf("/"))+"-",u="KeyboardEvent"in window?!1:!0,c={answer:"",encodedAnswer:"",codeMap:"",host:d},p=function(r){for(var l in c)r[l]=r[l]||c[l];d=r.host,n=r.answer,o=n.replace(/[^A-Za-z]/g,"").split(""),e=r.encoding?r.encoding:this.getEncodingFromString(r.encodedAnswer.replace(/[^A-Za-z]/g,"").split(""));for(var l in e)t[e[l]]=l;return this.renderBoard(),this.loadPuzzle(),this};p.prototype.constructor=p,p.prototype.getEncodingFromString=function(e){for(var t=new Object,n=0,r=o.length;r>n;n++)t[o[n]]=e[n];return t},p.prototype.renderBoard=function(){for(var t=n.split(/_|\s/g),o=[],l=0,i=t.length;i>l;l++){var a=t[l].split(""),s=document.createElement("DIV");s.className="word_div";for(var u=0,c=a.length;c>u;u++){var p=document.createElement("DIV");p.className="letter_div";var g=document.createElement("SPAN"),v=document.createElement("BR"),f=document.createElement("INPUT");f.type="text",f.size="1",f.maxLength="1",f.style.borderBottom="1px solid black",f.className="letterInputs encoded"+a[u],o.push(f);var I;null!==a[u].match(/[A-Za-z]{1}/)?(f.id="letterInput"+r,r++,I=document.createTextNode(e[a[u]]),g.className="overline",p.appendChild(f),p.appendChild(v)):I=document.createTextNode(a[u]),g.appendChild(I),p.appendChild(g),s.appendChild(p)}d.appendChild(s)}d.appendChild(document.createElement("BR"));var E=document.createElement("DIV");E.style.width="100%",E.style.marginBottom=E.style.marginTop="15px";var B=document.createElement("BUTTON");B.type="button";var w=document.createTextNode("Start Over");B.appendChild(w),B.id="clearBtn",B.title="Erase entries",E.appendChild(B);var C=document.createElement("BUTTON");C.type="button";var S=document.createTextNode("See Answer");C.appendChild(S),C.id="showBtn",C.title="Giving up so easily?",E.appendChild(C),d.appendChild(E);for(var l=o.length;l--;)m(o[l].id);return y("clearBtn"),h("showBtn"),this};var m=function(e){null!=document.getElementById(e)?u?document.getElementById(e).addEventListener("input",g,!1):(document.getElementById(e).addEventListener("keydown",function(e){l=this.value,e.keyCode>=65&&e.keyCode<=90&&(this.value="")},!1),document.getElementById(e).addEventListener("keyup",g,!1)):setTimeout(function(){m(e)},200)},y=function(e){null!=document.getElementById(e)?document.getElementById(e).addEventListener("click",p.prototype.clearEntries.bind(p.prototype),!1):setTimeout(function(){y(e)},200)},h=function(e){null!=document.getElementById(e)?document.getElementById(e).addEventListener("click",p.prototype.solvePuzzle.bind(p.prototype),!1):setTimeout(function(){h(e)},200)},g=function(e){for(var t=this.value,n=document.querySelectorAll("."+this.className.split(" ")[1]),o=0,r=n.length;r>o;o++)n[o].value=t.toUpperCase();p.prototype.savePuzzle(),e.keyCode>=65&&e.keyCode<=90||32==e.keyCode||13==e.keyCode||39==e.keyCode?p.prototype.advancePosition.call(this):37==e.keyCode&&p.prototype.reversePosition.call(this),p.prototype.isComplete()?(p.prototype.endPuzzle(),a=!0):a&&(p.prototype.clearHighlights(),a=!1)};return p.prototype.advancePosition=function(){return parseInt(this.id.substr(11),10)+1==r?(document.getElementById("letterInput0").focus(),document.getElementById("letterInput0").select()):(document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)+1)).focus(),document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)+1)).select()),this},p.prototype.reversePosition=function(){return 0==parseInt(this.id.substr(11),10)?(document.getElementById("letterInput"+(r-1)).focus(),document.getElementById("letterInput"+(r-1)).select()):(document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)-1)).focus(),document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)-1)).select()),this},p.prototype.solvePuzzle=function(){for(var e=d.querySelectorAll("input[type='text']"),t=0,n=e.length;n>t;t++)e[t].value=o[t];return this.endPuzzle(),this},p.prototype.isComplete=function(){for(var e=d.querySelectorAll("input[type='text']"),t=0,n=e.length;n>t;t++)if(e[t].value!=o[t])return!1;return!0},p.prototype.endPuzzle=function(){for(var e=d.querySelectorAll("input[type='text']"),t=0,n=e.length;n>t;t++)e[t].style.backgroundColor="yellow";for(var o=d.querySelectorAll(".overline"),t=0,n=o.length;n>t;t++)o[t].style.backgroundColor="#DDD";for(var r=d.querySelectorAll(".letter_div"),t=0,n=r.length;n>t;t++)r[t].classList.remove("letter_div"),r[t].classList.add("marginLess");return document.getElementById("showBtn").disabled=!0,this},p.prototype.clearHighlights=function(){for(var e=d.querySelectorAll("input[type='text']"),t=0,n=e.length;n>t;t++)e[t].style.backgroundColor="initial";for(var o=d.querySelectorAll(".overline"),t=0,n=o.length;n>t;t++)o[t].style.backgroundColor="initial";for(var r=d.querySelectorAll(".marginLess"),t=0,n=r.length;n>t;t++)r[t].classList.remove("marginLess"),r[t].classList.add("letter_div");return document.getElementById("showBtn").disabled=!1,this},p.prototype.clearEntries=function(){for(var e=d.querySelectorAll("input[type='text']"),t=0,n=e.length;n>t;t++)e[t].value="";for(t=0,n=o.length;n>t;t++)localStorage.setItem(s+"enteredLetters["+t+"]","");return this.clearHighlights(),this},p.prototype.loadPuzzle=function(){var e=d.querySelectorAll("input[type='text']");if(window.localStorage)for(i=0,len=e.length;i<len;i++)localStorage.getItem(s+"enteredLetters["+i+"]")?e[i].value=localStorage.getItem(s+"enteredLetters["+i+"]"):e[i].value="";return this},p.prototype.savePuzzle=function(){var e=d.querySelectorAll("input[type='text']");if(window.localStorage)for(i=0,len=o.length;i<len;i++)localStorage.setItem(s+"enteredLetters["+i+"]",e[i].value);return this},p}();