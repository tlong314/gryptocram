var Gryptocram=function(){var e={},t={},n="",o=[],r=0,l=document.body,d=!1,a=window.location.pathname.substr(window.location.pathname.lastIndexOf("/")+1,window.location.pathname.lastIndexOf(".html")-1-window.location.pathname.lastIndexOf("/"))+"-",s=!("KeyboardEvent"in window),u={answer:"",encodedAnswer:"",encoding:{A:"C",B:"Y",C:"M",D:"H",E:"X",F:"U",G:"W",H:"V",I:"Z",J:"T",K:"S",L:"R",M:"O",N:"F",O:"P",P:"N",Q:"L",R:"J",S:"I",T:"Q",U:"K",V:"G",W:"D",X:"B",Y:"E",Z:"A"},host:l},c=function(r){for(var i in u)r[i]=r[i]||u[i];for(var i in(l=r.host).classList.contains("grypt-host")||l.classList.add("grypt-host"),n=r.answer.toUpperCase(),o=n.replace(/[^A-Za-z]/g,"").split(""),e=r.encoding?r.encoding:this.getEncodingFromString(r.encodedAnswer.replace(/[^A-Za-z]/g,"").split("")))t[e[i]]=i;return this.renderBoard(),this.loadPuzzle(),this};c.prototype.constructor=c,c.prototype.getEncodingFromString=function(e){for(var t=new Object,n=0,r=o.length;n<r;n++)t[o[n]]=e[n];return t},c.prototype.renderBoard=function(){for(var t=n.split(/_|\s/g),o=[],i=0,d=t.length;i<d;i++){var a=t[i].split(""),s=document.createElement("DIV");s.className="word_div";for(var u=0,c=a.length;u<c;u++){var h=document.createElement("DIV"),g=document.createElement("SPAN"),v=document.createElement("BR"),f=document.createElement("INPUT"),I=null;h.className="letter_div",f.type="text",f.size="1",f.maxLength="1",f.style.borderBottom="1px solid black",f.className="letterInputs encoded"+a[u],o.push(f),null!==a[u].match(/[A-Za-z]{1}/)?(f.id="letterInput"+r,r++,I=document.createTextNode(e[a[u]]),g.className="overline",h.appendChild(f),h.appendChild(v)):I=document.createTextNode(a[u]),g.appendChild(I),h.appendChild(g),s.appendChild(h)}l.appendChild(s)}l.appendChild(document.createElement("BR"));var E=document.createElement("DIV");E.style.width="100%",E.style.marginBottom=E.style.marginTop="15px";var B=document.createElement("BUTTON");B.type="button";var C=document.createTextNode("Start Over");B.appendChild(C),B.id="clearBtn",B.title="Erase entries",E.appendChild(B);var w=document.createElement("BUTTON");w.type="button";var S=document.createTextNode("See Answer");w.appendChild(S),w.id="showBtn",w.title="Giving up so easily?",E.appendChild(w),l.appendChild(E);for(i=o.length;i--;)p(o[i].id,this);return m("clearBtn",this),y("showBtn",this),this};var p=function(e,t){null!=document.getElementById(e)?s?document.getElementById(e).addEventListener("input",h,!1):(document.getElementById(e).addEventListener("keydown",function(e){this.value,e.keyCode>=65&&e.keyCode<=90&&(this.value="")},!1),document.getElementById(e).addEventListener("keyup",h,!1)):setTimeout(function(){p(e,t)},200)},m=function(e,t){null!=document.getElementById(e)?document.getElementById(e).addEventListener("click",t.clearEntries.bind(t),!1):setTimeout(function(){m(e,t)},200)},y=function(e,t){null!=document.getElementById(e)?document.getElementById(e).addEventListener("click",t.solvePuzzle.bind(t),!1):setTimeout(function(){y(e,t)},200)},h=function(e){for(var t=this.value,n=document.querySelectorAll("."+this.className.split(" ")[1]),o=0,r=n.length;o<r;o++)n[o].value=t.toUpperCase();c.prototype.savePuzzle(),e.keyCode>=65&&e.keyCode<=90||32==e.keyCode||13==e.keyCode||39==e.keyCode?c.prototype.advancePosition.call(this):37==e.keyCode&&c.prototype.reversePosition.call(this),c.prototype.isComplete()?(c.prototype.endPuzzle(),d=!0):d&&(c.prototype.clearHighlights(),d=!1)};return c.prototype.advancePosition=function(){return parseInt(this.id.substr(11),10)+1==r?(document.getElementById("letterInput0").focus(),document.getElementById("letterInput0").select()):(document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)+1)).focus(),document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)+1)).select()),this},c.prototype.reversePosition=function(){return 0==parseInt(this.id.substr(11),10)?(document.getElementById("letterInput"+(r-1)).focus(),document.getElementById("letterInput"+(r-1)).select()):(document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)-1)).focus(),document.getElementById("letterInput"+(parseInt(this.id.substr(11),10)-1)).select()),this},c.prototype.solvePuzzle=function(){for(var e=l.querySelectorAll("input[type='text']"),t=0,n=e.length;t<n;t++)e[t].value=o[t];return this.endPuzzle(),this},c.prototype.isComplete=function(){for(var e=l.querySelectorAll("input[type='text']"),t=0,n=e.length;t<n;t++)if(e[t].value!=o[t])return!1;return!0},c.prototype.endPuzzle=function(){for(var e=l.querySelectorAll("input[type='text']"),t=0,n=e.length;t<n;t++)e[t].style.backgroundColor="yellow";var o=l.querySelectorAll(".overline");for(t=0,n=o.length;t<n;t++)o[t].style.backgroundColor="#DDD";var r=l.querySelectorAll(".letter_div");for(t=0,n=r.length;t<n;t++)r[t].classList.remove("letter_div"),r[t].classList.add("marginLess");return document.getElementById("showBtn").disabled=!0,this},c.prototype.clearHighlights=function(){for(var e=l.querySelectorAll("input[type='text']"),t=0,n=e.length;t<n;t++)e[t].style.backgroundColor="initial";var o=l.querySelectorAll(".overline");for(t=0,n=o.length;t<n;t++)o[t].style.backgroundColor="initial";var r=l.querySelectorAll(".marginLess");for(t=0,n=r.length;t<n;t++)r[t].classList.remove("marginLess"),r[t].classList.add("letter_div");return document.getElementById("showBtn").disabled=!1,this},c.prototype.clearEntries=function(){for(var e=l.querySelectorAll("input[type='text']"),t=0,n=e.length;t<n;t++)e[t].value="";for(t=0,n=o.length;t<n;t++)localStorage.setItem(a+"enteredLetters["+t+"]","");return this.clearHighlights(),this},c.prototype.loadPuzzle=function(){var e=l.querySelectorAll("input[type='text']");if(window.localStorage)for(i=0,len=e.length;i<len;i++)localStorage.getItem(a+"enteredLetters["+i+"]")?e[i].value=localStorage.getItem(a+"enteredLetters["+i+"]"):e[i].value="";return this},c.prototype.savePuzzle=function(){var e=l.querySelectorAll("input[type='text']");if(window.localStorage)for(i=0,len=o.length;i<len;i++)localStorage.setItem(a+"enteredLetters["+i+"]",e[i].value);return this},c}();